<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="MemberDao">
	
	<resultMap type="member" id="member">
		<result column="user_idx" property="userIdx"/>
		<result column="user_id" property="userId"/>
		<result column="user_password" property="userPassword"/>
		<result column="user_name" property="userName"/>
		<result column="user_email" property="userEmail"/>
		<result column="user_address" property="userAddress"/>
		<result column="user_sex" property="userSex"/>
		<result column="user_phone_number" property="userPhoneNumber"/>
		<result column="user_auth" property="userAuth"/>
		<result column="user_regist_date" property="userRegistDate"/>
		<result column="user_update_date" property="userUpdateDate"/>
		<result column="user_ip" property="userIp"/>
	</resultMap>
	
	<insert id="insertMember" parameterType="member">
		INSERT INTO member(user_idx, user_id, user_password, user_name, user_email, user_address, user_sex,
				user_phone_number, user_regist_date, user_update_date, user_ip)
			values(member_seq.nextval, #{userId}, #{userPassword}, #{userName}, #{userEmail},#{userAddress},
				#{userSex}, #{userPhoneNumber}, sysdate, sysdate, #{userIp})
	</insert>
	
	<select id="hasId" parameterType="string" resultType="int">
		SELECT count(*)
		FROM member
		WHERE user_id = #{userId}
	</select>
	
	<select id="getMember" parameterType="member" resultType="member" resultMap="member">
		SELECT *
		FROM member
		WHERE user_id = #{userId}
		AND user_password = #{userPassword}
	</select>
	
	
	<select id="memberList" resultType="member" parameterType="member" resultMap="member">
     	select *
     	from (
	     	SELECT *
			FROM member
			WHERE 1=1
			<if test="userId!=null">
			AND user_id LIKE '%'||#{userId, jdbcType=VARCHAR}||'%'
			</if>

			order by user_idx desc
			)
   </select>
</mapper>